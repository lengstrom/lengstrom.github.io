<html>
	<head>
		<title>PID Figures</title>
		<style type = 'text/css'>
			body {
				font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
				width: 960px;
				height: 500px;
				position: relative;
			}

			form {
				position: absolute;
				top: 1em;
				left: 1em;
			}

			path {
				fill-rule: evenodd;
				stroke: #333;
				stroke-width: 2px;
			}

			.central_gear path {
				fill: #ecf0f1;
			}
		</style>
	</head>
	<body>
		<script type="text/javascript" src='/vendor/d3.v3.min.js'></script>
		<script type="text/javascript">
			var width = 960,
				height = 500,
				radius = 80,
				x = Math.sin(2 * Math.PI / 3),
				y = Math.cos(2 * Math.PI / 3);

			var offset = 0,
				speed = 4,
				start = Date.now();

			var svg = d3.select("body").append("svg")
				.attr("width", width)
				.attr("height", height)
				.append("g")
				.attr("transform", "translate(50, 50)scale(.55)")
				.append("g");

			var frame = svg.append("g")
				.datum({radius: Infinity});

			frame.append("g")
				.attr("class", "central_gear")
				.datum({teeth: 16, radius: radius})
				.append("path")
				.attr("d", gear);

			function gear(d) {
				var n = d.teeth,
				r2 = Math.abs(d.radius),
					r0 = r2 - 8,
					r1 = r2 + 8,
					r3 = d.annulus ? (r3 = r0, r0 = r1, r1 = r3, r2 + 20) : 20,
					da = Math.PI / n,
					a0 = -Math.PI / 2 + (d.annulus ? Math.PI / n : 0),
					i = -1,
					path = ["M", r0 * Math.cos(a0), ",", r0 * Math.sin(a0)];
				while (++i < n) path.push(
					"A", r0, ",", r0, " 0 0,1 ", r0 * Math.cos(a0 += da), ",", r0 * Math.sin(a0),
					"L", r2 * Math.cos(a0), ",", r2 * Math.sin(a0),
					"L", r1 * Math.cos(a0 += da / 3), ",", r1 * Math.sin(a0),
					"A", r1, ",", r1, " 0 0,1 ", r1 * Math.cos(a0 += da / 3), ",", r1 * Math.sin(a0),
					"L", r2 * Math.cos(a0 += da / 3), ",", r2 * Math.sin(a0),
					"L", r0 * Math.cos(a0), ",", r0 * Math.sin(a0));
					path.push("M0,", -r3, "A", r3, ",", r3, " 0 0,0 0,", r3, "A", r3, ",", r3, " 0 0,0 0,", -r3, "Z");
				return path.join("");
			}

			d3.timer(function() {
				var angle = (Date.now() - start) * speed,
				transform = function(d) { return "rotate(" + angle / d.radius + ")"; };
				frame.selectAll("path").attr("transform", transform);
				frame.attr("transform", transform); // frame of reference
			});


		</script>
	</body>
</html>